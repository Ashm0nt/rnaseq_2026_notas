# Objetos de Bioconductor
Los objejetos de Bioconductor son estructuras de datos específicas que se utilizan para almacenar y organizar datos biológicos, como datos de expresión génica, datos de secuenciación, etc. Estos objetos proporcionan una forma estandarizada de representar y manipular datos biológicos, lo que facilita el análisis y la interpretación de los resultados de los experimentos biológicos. Algunos ejemplos de objetos de Bioconductor incluyen SummarizedExperiment, GenomicRanges, rtracklayer, iSEE, entre otros. Cada uno de estos objetos tiene su propia estructura y funciones asociadas que permiten a los usuarios trabajar con sus datos biológicos de manera eficiente y efectiva.

## SummarizedExperiment
SummarizedExperiment es una clase de datos en Bioconductor que se utiliza para almacenar y organizar datos biológicos, como datos de expresión génica, datos de secuenciación, etc. Esta clase proporciona una estructura de datos que permite almacenar tanto los datos biológicos como la información de anotación asociada, como la información de los genes, las muestras, etc.

Tenemos que tener al menos tres tipos de tablas ligadas

- colData: Información de las muestras, como el tipo de muestra, la condición experimental, etc.
- rowRanges: Información de las filas, como la ubicación genómica, la anotación de genes, etc.
- assays: Datos biológicos, como los valores de expresión génica, los recuentos de secuenciación, etc. (Una o más tablas de datos biológicos, cada una con un nombre específico, como "counts", "log2Counts", etc.)
- exptData: Información adicional sobre el experimento, como la fecha de realización, el laboratorio, metadatos, etc.

```{r}
se <- SummarizedExperiment(
  assays,
  colData,
  rowRanges,
  exptData
)
```

## GenomicRanges
GenomicRanges es una clase de datos en Bioconductor que se utiliza para representar y manipular rangos genómicos, que son intervalos de secuencia en el genoma. Esta clase proporciona una estructura de datos que permite almacenar información sobre la ubicación genómica, la anotación de genes, etc., y proporciona funciones para realizar operaciones comunes en rangos genómicos, como la intersección, la unión, la diferencia, etc.

```{r}
gr <- GRanges(
    seqnames = Rle(c("chr1", "chr2", "chr3")),
    ranges = IRanges(c(1, 100, 200), width = c(100, 50, 75)),
    strand = Rle(c("+", "-", "*")),
    score = c(10, 20, 30),
    GC = c(0.5, 0.6, 0.7)
```

## rtracklayer
rtracklayer es un paquete de Bioconductor que proporciona funciones para importar y exportar datos genómicos en diferentes formatos, como BED, GFF, WIG, etc. Este paquete permite a los usuarios leer y escribir archivos de datos genómicos, lo que facilita la integración de datos genómicos en análisis biológicos y la visualización de datos genómicos en herramientas como IGV (Integrative Genomics Viewer).

### Objeto de SummarizedExperiment

```{r}
## Lets build our first SummarizedExperiment object
library("GenomeInfoDb")
library("SummarizedExperiment")
## ?SummarizedExperiment

## De los ejemplos en la ayuda oficial

## Creamos los datos para nuestro objeto de tipo SummarizedExperiment
## para 200 genes a lo largo de 6 muestras
nrows <- 200
ncols <- 6
## Números al azar de cuentas
set.seed(20210223)
counts <- matrix(runif(nrows * ncols, 1, 1e4), nrows)
## Información de nuestros genes
rowRanges <- GRanges(
    rep(c("chr1", "chr2"), c(50, 150)),
    IRanges(floor(runif(200, 1e5, 1e6)), width = 100),
    strand = sample(c("+", "-"), 200, TRUE),
    feature_id = sprintf("ID%03d", 1:200)
)
names(rowRanges) <- paste0("gene_", seq_len(length(rowRanges)))
## Información de nuestras muestras
colData <- DataFrame(
    Treatment = rep(c("ChIP", "Input"), 3),
    row.names = LETTERS[1:6]
)
## Juntamos ahora toda la información en un solo objeto de R
rse <- SummarizedExperiment(
    assays = SimpleList(counts = counts),
    rowRanges = rowRanges,
    colData = colData
)

## Exploremos el objeto resultante
rse
```

valores del eje y son los valores del gen 3 separados por el tratamiento

```{r}
y <- rse$Treatment ## Tambien funciona con colData(rse)$Treatment
x <- as.numeric(assay(rse)[3, ])
boxplot(x ~ y)

summary(lm(x ~ y))


```


## iSEE
iSEE es un paquete de Bioconductor que proporciona una interfaz interactiva para explorar y visualizar datos biológicos almacenados en objetos de tipo SummarizedExperiment. Este paquete permite a los usuarios crear gráficos interactivos, como gráficos de dispersión, gráficos de barras, gráficos de violín, etc., para explorar la relación entre diferentes variables en sus datos biológicos. iSEE facilita la identificación de patrones, tendencias y relaciones en los datos biológicos, lo que puede ser útil para generar hipótesis y comprender mejor los resultados de los experimentos biológicos.

Está construido sobre la base de Shiny, lo que permite a los usuarios interactuar con los gráficos y explorar los datos de manera dinámica. iSEE es especialmente útil para analizar datos de expresión génica, datos de secuenciación, datos de metilación, etc., almacenados en objetos de tipo SummarizedExperiment.

**SingleCEllExperiment** es una clase de datos en Bioconductor que se utiliza para almacenar y organizar datos de células individuales, como datos de expresión génica a nivel de célula única, datos de secuenciación a nivel de célula única, etc. Esta clase proporciona una estructura de datos que permite almacenar tanto los datos biológicos a nivel de célula única como la información de anotación asociada, como la información de las células, las muestras, etc.

- Reduced dimension plot
- Column data plot
- Feature assay plot
- Heatmap plot
- Row statistics table 

Se pueden conectar paneles uos con otros, por ejemplo, un gráfico de dispersión con un gráfico de barras, para que al seleccionar un punto en el gráfico de dispersión, se actualice automáticamente el gráfico de barras para mostrar la información correspondiente a ese punto seleccionado. Esto permite a los usuarios explorar y analizar sus datos de manera más interactiva y dinámica, facilitando la identificación de patrones y relaciones en los datos biológicos a nivel de célula única.

```{r}
library("iSEE")
sce_layer <- spatialLIBD::fetch_data("sce_layer")
sce_layer
lobstr::obj_size(sce_layer)
iSEE::iSEE(sce_layer)
```